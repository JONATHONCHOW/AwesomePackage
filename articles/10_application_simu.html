<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AwesomePackage">
<title>Applications I: Simulated Data Sets • AwesomePackage</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Applications I: Simulated Data Sets">
<meta property="og:description" content="AwesomePackage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AwesomePackage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/AwesomePackage.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/05_theory_em.html">Models and Methods I: Fit PSD Model by EM Algorithm</a>
    <a class="dropdown-item" href="../articles/06_theory_sqp.html">Models and Methods II: Fit PSD Model by SQP Algorithm</a>
    <a class="dropdown-item" href="../articles/07_theory_vi.html">Models and Methods III: Fit PSD Model by VI Algorithm</a>
    <a class="dropdown-item" href="../articles/08_theory_svi.html">Models and Methods IV: Fit PSD Model by SVI Algorithm</a>
    <a class="dropdown-item" href="../articles/09_theory_model.html">Models and Methods V: Relationship between PSD Model and Other Models</a>
    <a class="dropdown-item" href="../articles/10_application_simu.html">Applications I: Simulated Data Sets</a>
    <a class="dropdown-item" href="../articles/11_application_tgp.html">Applications II: TGP Data Set</a>
    <a class="dropdown-item" href="../articles/12_application_hgdp.html">Applications III: HGDP Data Set</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JONATHONCHOW/AwesomePackage/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Applications I: Simulated Data Sets</h1>
                        <h4 data-toc-skip class="author">Jonathon Chow</h4>
            
            <h4 data-toc-skip class="date">2022-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JONATHONCHOW/AwesomePackage/blob/HEAD/vignettes/10_application_simu.Rmd" class="external-link"><code>vignettes/10_application_simu.Rmd</code></a></small>
      <div class="d-none name"><code>10_application_simu.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>  To evaluate the performance of the different learning algorithms, we generated two groups of simulated genotype data sets. In simulated data set A, we focus on the influence of the strength of population structure and the choice of parameter <code>K</code> on the performance of different algorithms. In simulated data set B, we focus on the performance of different algorithms when the mixing ratio gap between different individuals is small.</p>
</div>
<div class="section level2">
<h2 id="simulated-data-set-a">Simulated Data Set A<a class="anchor" aria-label="anchor" href="#simulated-data-set-a"></a>
</h2>
<div class="section level3">
<h3 id="generate-the-data-set">Generate the data set<a class="anchor" aria-label="anchor" href="#generate-the-data-set"></a>
</h3>
<p>  We generated the simulated data set A <span class="citation">(Raj, Stephens, and Pritchard 2014)</span> in three steps. First, generate the population scale matrix <span class="math inline">\(P\)</span> using the Dirichlet distribution; In the second step, the gene scale matrix <span class="math inline">\(F\)</span> is generated using beta distribution. The third step is to generate the genotype matrix <span class="math inline">\(G\)</span> using the binomial distribution. We set the number of individuals <span class="math inline">\(I\)</span> to 600, the number of SNPs <span class="math inline">\(J\)</span> to 2500, and the number of populations <span class="math inline">\(K\)</span> to 3.</p>
<p>  Step 1. The population scales for each sample are drawn from a symmetric Dirichlet distribution to simulate small amounts of gene flow between the three populations. Here we use <span class="math inline">\(Dirichlet(\frac{1}{10}\textbf{1}_3)\)</span>, of course, in the implementation code, we can adjust the parameters of the Dirichlet distribution.</p>
<p>  Step 2. The ancestral allele frequencies <span class="math inline">\(\bar{f_j}\)</span> for each SNP are drawn from a natural data set to simulate allele frequencies in natural populations. Here we use the HGDP data set. First, <span class="math inline">\(\bar{f_j}\)</span> is equal to the total number of suballeles observed at the <span class="math inline">\(j\)</span>th SNP divided by twice the number of individuals. Then, we assume that the samples are drawn from a three-population demographic model. The edge weights correspond to the parameter <span class="math inline">\(F_k\)</span> <span class="citation">(Wright 1949)</span> <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In population genetics, F-statistics (also known as fixation indices) describe the statistically expected level of heterozygosity in a population; more specifically the expected degree of (usually) a reduction in heterozygosity when compared to Hardy–Weinberg expectation.&lt;/p&gt;"><sup>1</sup></a> in the model that quantifies the genetic drift of each of the three current populations from an ancestral population. Here we choose <span class="math inline">\((F_1,F_2,F_3)=(0.1,0.05,0.01)\)</span> to simulate strong structure and <span class="math inline">\((F_1,F_2,F_3)=0.5\times(0.1,0.05,0.01)\)</span> to simulate weak structure. Thus, the allele frequency at a given locus for each population is drawn from a beta distribution <span class="citation">(Balding and Nichols 1995)</span> <span class="math inline">\(f_{kj}\sim Beta\Big(\frac{1-F_k}{F_k}\bar{f_j},\frac{1-F_k}{F_k}(1-\bar{f_j})\Big)\)</span>.</p>
<p>  Step 3. According to the PSD model, each element <span class="math inline">\(g_{ij}\)</span> of the matrix <span class="math inline">\(G\)</span> follows a binomial distribution with probability <span class="math inline">\((PF)_{ij}=\sum_{i=1}^Kp_{ik}f_{kj}\)</span> and number of trials 2.</p>
</div>
<div class="section level3">
<h3 id="fit-the-data">Fit the data<a class="anchor" aria-label="anchor" href="#fit-the-data"></a>
</h3>
<p>  We use the function <code>psd_simulation</code> in package AwesomePackage directly.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JONATHONCHOW/AwesomePackage" class="external-link">AwesomePackage</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_simuA_strong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_simulation.html">psd_simulation</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">2500</span>, <span class="fl">3</span>, type.id <span class="op">=</span> <span class="st">"A"</span>, </span>
<span>                                    parm_F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_simuA_weak</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_simulation.html">psd_simulation</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">2500</span>, <span class="fl">3</span>, type.id <span class="op">=</span> <span class="st">"A"</span>, </span>
<span>                                  parm_F <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>  We use different algorithms and different <code>K</code> to fit strong and weak structure data sets respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_simuA_strong_em_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===============&gt;-----------------------------------------------] 520/2000 (44s)</span></span>
<span><span class="va">result_simuA_strong_em_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=================&gt;---------------------------------------------] 580/2000 ( 2m)</span></span>
<span></span>
<span><span class="va">result_simuA_strong_sqp_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 (17s)</span></span>
<span><span class="co"># [=========&gt;-------------------------------------------------------] 30/200 (17s)</span></span>
<span><span class="va">result_simuA_strong_sqp_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 (37s)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 ( 1m)</span></span>
<span></span>
<span><span class="va">result_simuA_strong_vi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===================&gt;-------------------------------------------] 650/2000 (39s)</span></span>
<span><span class="va">result_simuA_strong_vi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;-----------------------------] 1070/2000 ( 1m)</span></span>
<span></span>
<span><span class="va">result_simuA_strong_svi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>,</span>
<span>                                          <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                          <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                          <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                          <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==============&gt;--------------------------------------------] 130000/5e+05 (13m)</span></span>
<span><span class="va">result_simuA_strong_svi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>,</span>
<span>                                          <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                          <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                          <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                          <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=============&gt;---------------------------------------------] 120000/5e+05 (12m)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_simuA_weak_em_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [====================&gt;------------------------------------------] 660/2000 ( 1m)</span></span>
<span><span class="va">result_simuA_weak_em_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==================&gt;--------------------------------------------] 610/2000 ( 2m)</span></span>
<span></span>
<span><span class="va">result_simuA_weak_sqp_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 (18s)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 (28s)</span></span>
<span><span class="va">result_simuA_weak_sqp_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 (39s)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 ( 1m)</span></span>
<span></span>
<span><span class="va">result_simuA_weak_vi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=====================&gt;-----------------------------------------] 710/2000 (46s)</span></span>
<span><span class="va">result_simuA_weak_vi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=======================================================&gt;------] 1810/2000 ( 2m)</span></span>
<span></span>
<span><span class="va">result_simuA_weak_svi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>,</span>
<span>                                        <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                        <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                        <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                        <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=======================&gt;------------------------------------] 2e+05/5e+05 (19m)</span></span>
<span><span class="va">result_simuA_weak_svi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>,</span>
<span>                                        <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                        <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                        <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                        <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==================&gt;----------------------------------------] 160000/5e+05 (19m)</span></span></code></pre></div>
<p>  We store the result as <code>result_simuA.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>  We import the data directly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_simuA.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">data_simuA_strong</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: REAL | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_em_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: EM | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_sqp_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: SQP | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_vi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: VI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_svi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: SVI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_em_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: EM | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_sqp_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: SQP | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_vi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: VI | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_strong_svi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (strong) | Method: SVI | K: 5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="10_application_simu_files/figure-html/unnamed-chunk-6-1.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-2.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-3.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-4.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-5.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-6.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-7.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-8.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-6-9.png" width="864"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">data_simuA_weak</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: REAL | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_em_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: EM | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_sqp_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: SQP | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_vi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: VI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_svi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: SVI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_em_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: EM | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_sqp_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: SQP | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_vi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: VI | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuA_weak_svi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuA (weak) | Method: SVI | K: 5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="10_application_simu_files/figure-html/unnamed-chunk-7-1.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-2.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-3.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-4.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-5.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-6.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-7.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-8.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-7-9.png" width="864"></p>
</div>
<div class="section level3">
<h3 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h3>
<p>  The main purpose of simulated data set A is to study the influence of the strength of population structure and the choice of parameter <code>K</code> on the performance of different algorithms.</p>
<p>  For EM and SQP algorithms, they tend to reveal details, that is, they are sensitive to parameter <code>K</code> and structure strength. With the appropriate parameter <code>K</code>, this may be an advantage, as it reveals a finer structure. However, when the parameter <code>K</code> is too large, the phenomenon of overfitting is easy to occur. In addition, SQP algorithm is more accurate than EM algorithm.</p>
<p>  For the VI algorithm, we notice that the results of VI are almost consistent for both parameter <code>K</code> and structure strength changes. This means that the VI algorithm only tends to reveal the main factors, thereby ignoring some smaller contributions. This is both a strength and a weakness.</p>
<p>  The SVI algorithm is an ideal choice in many cases, because it can both highlight the main parts like VI, and react acutely when the structure is not obvious like EM and SQP.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulated-data-set-b">Simulated Data Set B<a class="anchor" aria-label="anchor" href="#simulated-data-set-b"></a>
</h2>
<div class="section level3">
<h3 id="generate-the-data-set-1">Generate the data set<a class="anchor" aria-label="anchor" href="#generate-the-data-set-1"></a>
</h3>
<p>  We also use three steps to generate simulated data set B. In the second step, we set all <span class="math inline">\(F_k\)</span> to 0.1. The third step is the same as for data set A. We just consider the first step. We set a Gaussian density for each ancestral population centered at its location and normalizing each individual such that all proportions sum to 1 <span class="citation">(Gopalan et al. 2016)</span>. In this case, each ancestral population is placed at a location evenly spaced along a line. Individuals are also positioned evenly on the line, and their proportions <span class="math inline">\(p_{ik}\)</span> are a function of their proximity to each population’s location. We set the number of individuals <span class="math inline">\(I\)</span> to 1000, the number of SNPs <span class="math inline">\(J\)</span> to 5000, and the number of populations <span class="math inline">\(K\)</span> to 5.</p>
</div>
<div class="section level3">
<h3 id="fit-the-data-1">Fit the data<a class="anchor" aria-label="anchor" href="#fit-the-data-1"></a>
</h3>
<p>  We use the function <code>psd_simulation</code> in package AwesomePackage directly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_simuB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_simulation.html">psd_simulation</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">5000</span>, <span class="fl">5</span>, type.id <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></code></pre></div>
<p>  We use different algorithms and different <code>K</code> to fit the data set.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_simuB_em_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=========&gt;-----------------------------------------------------] 330/2000 ( 2m)</span></span>
<span><span class="va">result_simuB_em_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==============&gt;------------------------------------------------] 480/2000 ( 5m)</span></span>
<span></span>
<span><span class="va">result_simuB_sqp_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 1m)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------------] 40/200 ( 1m)</span></span>
<span><span class="va">result_simuB_sqp_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 2m)</span></span>
<span><span class="co"># [===================&gt;---------------------------------------------] 60/200 ( 5m)</span></span>
<span></span>
<span><span class="va">result_simuB_vi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [============&gt;--------------------------------------------------] 400/2000 ( 1m)</span></span>
<span><span class="va">result_simuB_vi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=======================&gt;---------------------------------------] 770/2000 ( 3m)</span></span>
<span></span>
<span><span class="va">result_simuB_svi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">3</span>,</span>
<span>                                   <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                   <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                   <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                   <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------] 110000/5e+05 (13m)</span></span>
<span><span class="va">result_simuB_svi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">G</span>, <span class="fl">5</span>,</span>
<span>                                   <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                   <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                   <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                   <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [================&gt;------------------------------------------] 140000/5e+05 (20m)</span></span></code></pre></div>
<p>  We store the result as <code>result_simuB.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="results-1">Results<a class="anchor" aria-label="anchor" href="#results-1"></a>
</h3>
<p>  We import the data directly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_simuB.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">data_simuB</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: REAL | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_em_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: EM | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_sqp_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: SQP | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_vi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: VI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_svi_K3</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: SVI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_em_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: EM | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_sqp_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: SQP | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_vi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: VI | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_simuB_svi_K5</span><span class="op">$</span><span class="va">P</span>, pops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: simuB | Method: SVI | K: 5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="10_application_simu_files/figure-html/unnamed-chunk-11-1.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-2.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-3.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-4.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-5.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-6.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-7.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-8.png" width="864"><img src="10_application_simu_files/figure-html/unnamed-chunk-11-9.png" width="864"></p>
</div>
<div class="section level3">
<h3 id="discussion-1">Discussion<a class="anchor" aria-label="anchor" href="#discussion-1"></a>
</h3>
<p>  The main purpose of simulated data set B is to study the performance of different algorithms when the mixing ratio gap between different individuals is small. In this case, EM algorithm and SQP algorithm can more faithfully reflect the structure of the dataset (the former is better), while VI algorithm and SVI algorithm will overemphasize some features (the former is worse).</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="literature-cited">Literature Cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-balding1995method" class="csl-entry">
Balding, David J, and Richard A Nichols. 1995. <span>“A Method for Quantifying Differentiation Between Populations at Multi-Allelic Loci and Its Implications for Investigating Identity and Paternity.”</span> <em>Genetica</em> 96 (1): 3–12.
</div>
<div id="ref-gopalan2016scaling" class="csl-entry">
Gopalan, Prem, Wei Hao, David M Blei, and John D Storey. 2016. <span>“Scaling Probabilistic Models of Genetic Variation to Millions of Humans.”</span> <em>Nature Genetics</em> 48 (12): 1587–90.
</div>
<div id="ref-raj2014faststructure" class="csl-entry">
Raj, Anil, Matthew Stephens, and Jonathan K Pritchard. 2014. <span>“fastSTRUCTURE: Variational Inference of Population Structure in Large SNP Data Sets.”</span> <em>Genetics</em> 197 (2): 573–89.
</div>
<div id="ref-wright1949genetical" class="csl-entry">
Wright, Sewall. 1949. <span>“The Genetical Structure of Populations.”</span> <em>Annals of Eugenics</em> 15 (1): 323–54.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonathon Chow.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
