<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AwesomePackage">
<title>AwesomePackage: Quick Start â€¢ AwesomePackage</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="AwesomePackage: Quick Start">
<meta property="og:description" content="AwesomePackage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AwesomePackage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/AwesomePackage.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_quick_start.html">AwesomePackage: Quick Start</a>
    <a class="dropdown-item" href="../articles/02_user_manual.html">AwesomePackage: User Manual 1.4.0</a>
    <a class="dropdown-item" href="../articles/03_report.html">AwesomePackage: A Valid R Package for Ancestry Inference</a>
    <a class="dropdown-item" href="../articles/04_presentation.html">AwesomePackage: A Valid R Package for Ancestry Inference (slide)</a>
    <a class="dropdown-item" href="../articles/05_theory_em.html">Models and Methods I: Fit PSD Model by EM Algorithm</a>
    <a class="dropdown-item" href="../articles/06_theory_sqp.html">Models and Methods II: Fit PSD Model by SQP Algorithm</a>
    <a class="dropdown-item" href="../articles/07_theory_vi.html">Models and Methods III: Fit PSD Model by VI Algorithm</a>
    <a class="dropdown-item" href="../articles/08_theory_svi.html">Models and Methods IV: Fit PSD Model by SVI Algorithm</a>
    <a class="dropdown-item" href="../articles/09_theory_model.html">Models and Methods V: Relationship between PSD Model and Other Models</a>
    <a class="dropdown-item" href="../articles/10_application_simu.html">Applications I: Simulated Data Sets</a>
    <a class="dropdown-item" href="../articles/11_application_tgp.html">Applications II: TGP Data Set</a>
    <a class="dropdown-item" href="../articles/12_application_hgdp.html">Applications III: HGDP Data Set</a>
    <a class="dropdown-item" href="../articles/13_note_fasttopics.html">Notes I: Package fastTopics</a>
    <a class="dropdown-item" href="../articles/14_note_faststructure.html">Notes II: Package fastSTRUCTURE</a>
    <a class="dropdown-item" href="../articles/15_note_terastructure.html">Notes III: Package TeraStucture</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JONATHONCHOW/AwesomePackage/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>AwesomePackage: Quick Start</h1>
                        <h4 data-toc-skip class="author">Jonathon
Chow</h4>
            
            <h4 data-toc-skip class="date">2022-10-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JONATHONCHOW/AwesomePackage/blob/HEAD/vignettes/AwesomePackage.Rmd" class="external-link"><code>vignettes/AwesomePackage.Rmd</code></a></small>
      <div class="d-none name"><code>AwesomePackage.Rmd</code></div>
    </div>

    
    
<p>This vignette is a brief introduction to AwesomePackage. You first
need to library AwesomePackage. You will use the package data:
<code>data_TGP</code>, <code>data_HGDP</code>, <code>map_TGP</code>,
<code>map_HGDP</code>. See <em>Reference</em> in <a href="https://jonathonchow.github.io/AwesomePackage/">AwesomePackage</a>
for an introduction of these data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JONATHONCHOW/AwesomePackage" class="external-link">AwesomePackage</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="fit-psd-model">Fit PSD model<a class="anchor" aria-label="anchor" href="#fit-psd-model"></a>
</h2>
<div class="section level3">
<h3 id="psd-model-and-data">PSD model and data<a class="anchor" aria-label="anchor" href="#psd-model-and-data"></a>
</h3>
<p>We consider the sample data from the 1000 Genomes Project (TGP) and
use a PSD model to fit these data. We import the pre-trained results
directly.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_fit_psd.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-psd-model-by-em-algorithm">Fit PSD model by EM algorithm<a class="anchor" aria-label="anchor" href="#fit-psd-model-by-em-algorithm"></a>
</h3>
<p>We fit the PSD model with EM algorithm, and use the loss function as
a stopping criterion. EM algorithm converges slowly. It takes about 450
EM iterations to reach the predetermined accuracy.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [=========================================================&gt;------] 450/500 ( 3m)</span></span></code></pre></div>
<p>We plot the loss function against the number of iterations using
package ggplot2, the loss function records once for 10 iterations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">result_TGP_em</span><span class="op">$</span><span class="va">Loss</span></span>
<span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, <span class="st">"em"</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>We plot the ancestral proportions of individuals using package
ggplot2. The fitting result of EM algorithm is not very accurate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_TGP_em</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We measure the prediction accuracy of the dataset by the maximum
likelihood function and the deviance residuals.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.5971432</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="va">result_TGP_em</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3374755</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fit-psd-model-by-sqp-algorithm">Fit PSD model by SQP algorithm<a class="anchor" aria-label="anchor" href="#fit-psd-model-by-sqp-algorithm"></a>
</h3>
<p>We fit the PSD model with SQP algorithm, and use the loss function as
a stopping criterion. Although SQP algorithm converges fast, it is easy
to converge to the local optimal value. To prevent this bad scenario, we
start with 100 EM iterations, and then only need about 40 SQP iterations
to reach the accuracy requirement.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP_sqp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 100/100 (35s)</span></span>
<span><span class="co"># [====================================================&gt;-------------] 40/50 ( 1m)</span></span></code></pre></div>
<p>We plot the loss function against the number of iterations using
package ggplot2, the loss function records once for 10 iterations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">result_TGP_sqp</span><span class="op">$</span><span class="va">Loss</span></span>
<span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, <span class="st">"em &amp; sqp"</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We plot the ancestral proportions of individuals using package
ggplot2. Notice that the fitting result of the SQP algorithm is
excellent.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_TGP_sqp</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We measure the prediction accuracy of the dataset by the maximum
likelihood function and the deviance residuals.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.5969287</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="va">result_TGP_sqp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3372611</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fit-psd-model-by-vi-algorithm">Fit PSD model by VI algorithm<a class="anchor" aria-label="anchor" href="#fit-psd-model-by-vi-algorithm"></a>
</h3>
<p>We fit the PSD model with VI algorithm, and use the loss function as
a stopping criterion. Similar to EM algorithm, the convergence of VI
algorithm is also relatively slow, and about 490 iterations are needed
to reach the accuracy requirement.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [==============================================================&gt;-] 490/500 ( 2m)</span></span></code></pre></div>
<p>We plot the loss function against the number of iterations using
package ggplot2, the loss function records once for 10 iterations.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">result_TGP_vi</span><span class="op">$</span><span class="va">Loss</span></span>
<span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, <span class="st">"vi"</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>We plot the ancestral proportions of individuals using package
ggplot2. The fitting result is much better than EM algorithm.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_TGP_vi</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We measure the prediction accuracy of the dataset by the evidence of
lower bound (ELBO), the maximum likelihood function and the deviance
residuals.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.6103088</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psd_loglikelihood.html">psd_loglikelihood</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="va">result_TGP_vi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.59751</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="va">result_TGP_vi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3378423</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fit-psd-model-by-svi-algorithm">Fit PSD model by SVI algorithm<a class="anchor" aria-label="anchor" href="#fit-psd-model-by-svi-algorithm"></a>
</h3>
<p>We fit the PSD model with SVI algorithm, and use the loss function as
a stopping criterion. We completed the fitting in 13 min, little longer
than the previous three algorithms. Although SVI algorithm is known for
its fast speed, this is for the dataset with a large number of
individuals. It can be predicted that for the complete TGP data, SVI
algorithm still needs about the same time, but the time of other
algorithms will be greatly increased. Perhaps the time of these
algorithms is similar for data similar to TGP data size, but if the
number of individuals is large, the performance of SVI algorithm is much
better, which is also the superiority of SVI algorithm.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP_svi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="fl">3</span>,</span>
<span>                              <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                              <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                              <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                              <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------] 110000/5e+05 (13m)</span></span></code></pre></div>
<p>We plot the loss function against the number of iterations using
package ggplot2, the loss function records once for 10,000 iterations.
The most natural thing to do is to use the change in the loss function
as a stopping criterion, but as can be seen below, this is the loss
function on the validation set so is not necessarily monotonic. When the
sampling interval is too large, the loss function will oscillate near
the optimal value, so that the cycle cannot be finished. When the
sampling interval is too small, the loss function will be almost
constant, resulting in premature exit from the loop. However, proper
sampling intervals are difficult to find. We simply added a maximum
number of iterations (in this case, 50,000) as a stopping criterion, and
the loss function was only used as a post-hoc metric.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">result_TGP_svi</span><span class="op">$</span><span class="va">Loss</span></span>
<span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>We plot the ancestral proportions of individuals using package
ggplot2. The convergence accuracy of SVI algorithm is also very
good.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_TGP_svi</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>We measure the prediction accuracy of the dataset by the maximum
likelihood function of the validation set.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP_svi</span><span class="op">$</span><span class="va">MaxLoss</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.614379</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="structure-plot">Structure plot<a class="anchor" aria-label="anchor" href="#structure-plot"></a>
</h2>
<p>We analyze the structure diagrams of the above four algorithms for
TGP and HGDP. We import the pre-trained results directly.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_structure_plot.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="tgp">TGP<a class="anchor" aria-label="anchor" href="#tgp"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_TGP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_TGP</span>, <span class="fl">4</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=========================&gt;-------------------------------------] 840/2000 ( 4m)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_TGP</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_TGP</span><span class="op">)</span></span>
<span><span class="va">lpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_TGP</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_TGP</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_TGP</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Large populations.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span>, label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Small populations.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span>, label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">spop</span>, gap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="hgdp">HGDP<a class="anchor" aria-label="anchor" href="#hgdp"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">7</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=============================&gt;---------------------------------] 940/2000 ( 5m)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">result_HGDP</span><span class="op">$</span><span class="va">P</span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_HGDP</span><span class="op">)</span></span>
<span><span class="va">lpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Large populations.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span>, label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Small populations.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">P</span>, label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">spop</span>, gap <span class="op">=</span> <span class="fl">3</span>, font.size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="AwesomePackage_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="choose-hyper-parameter-k">Choose hyper-parameter <code>K</code><a class="anchor" aria-label="anchor" href="#choose-hyper-parameter-k"></a>
</h2>
<p>We fit different hyperparameters <code>K</code> respectively, and
select the <code>K</code> that makes some indices optimal. We conduct
experiments on TPG and HGDP datasets and different algorithms
separately. See <em>Articles</em> in <a href="https://jonathonchow.github.io/AwesomePackage/">AwesomePackage</a>
for details.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonathon Chow.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
