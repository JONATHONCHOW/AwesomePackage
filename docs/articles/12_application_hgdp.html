<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AwesomePackage">
<title>Applications III: HGDP Data Set • AwesomePackage</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Applications III: HGDP Data Set">
<meta property="og:description" content="AwesomePackage">
<meta property="og:image" content="https://jonathonchow.github.io/AwesomePackage/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AwesomePackage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/AwesomePackage.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_quick_start.html">AwesomePackage: Brief Introduction</a>
    <a class="dropdown-item" href="../articles/02_user_manual.html">AwesomePackage: User Manual 2.0.0</a>
    <a class="dropdown-item" href="../articles/03_report.html">AwesomePackage: A Valid R Package for Ancestry Inference</a>
    <a class="dropdown-item" href="../articles/04_presentation.html">AwesomePackage: A Valid R Package for Ancestry Inference (slide)</a>
    <a class="dropdown-item" href="../articles/05_theory_em.html">Models and Methods I: Fit PSD Model by EM Algorithm</a>
    <a class="dropdown-item" href="../articles/06_theory_sqp.html">Models and Methods II: Fit PSD Model by SQP Algorithm</a>
    <a class="dropdown-item" href="../articles/07_theory_vi.html">Models and Methods III: Fit PSD Model by VI Algorithm</a>
    <a class="dropdown-item" href="../articles/08_theory_svi.html">Models and Methods IV: Fit PSD Model by SVI Algorithm</a>
    <a class="dropdown-item" href="../articles/09_theory_model.html">Models and Methods V: Relationship between PSD Model and Other Models</a>
    <a class="dropdown-item" href="../articles/10_application_simu.html">Applications I: Simulated Data Sets</a>
    <a class="dropdown-item" href="../articles/11_application_tgp.html">Applications II: TGP Data Set</a>
    <a class="dropdown-item" href="../articles/12_application_hgdp.html">Applications III: HGDP Data Set</a>
    <a class="dropdown-item" href="../articles/13_note_fasttopics.html">Notes I: Package fastTopics</a>
    <a class="dropdown-item" href="../articles/14_note_faststructure.html">Notes II: Package fastSTRUCTURE</a>
    <a class="dropdown-item" href="../articles/15_note_terastructure.html">Notes III: Package TeraStucture</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JONATHONCHOW/AwesomePackage/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Applications III: HGDP Data Set</h1>
                        <h4 data-toc-skip class="author">Jonathon
Chow</h4>
            
            <h4 data-toc-skip class="date">2022-10-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JONATHONCHOW/AwesomePackage/blob/HEAD/vignettes/12_application_hgdp.Rmd" class="external-link"><code>vignettes/12_application_hgdp.Rmd</code></a></small>
      <div class="d-none name"><code>12_application_hgdp.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>  A group of scientists at Stanford University have collaborated on a
large study to understand genetic diversity in human populations. They
analyzed genomic DNA from 1,043 individuals from around the world,
determining their genotypes at more than 650,000 SNP loci, with the
Illumina BeadStation technology. Genomic DNA samples from these
fully-consenting individuals were collected by the Human Genome
Diversity Project (HGDP), in a collaboration with the Centre Etude
Polymorphism Humain (CEPH) in Paris. The collection they tested is
referred to as the “HGDP-CEPH Human Genome Diversity Cell Line Panel”
<span class="citation">(Cann et al. 2002)</span>. They represent 51
different populations from Africa, Europe, the Middle East, South and
Central Asia, East Asia, Oceania and the Americas. The HGDP includes the
51 populations from around the world <span class="citation">(Li et al.
2008)</span>. A description of the populations that were studied can be
found in a 2005 review paper by Cavalli-Sforza <span class="citation">(Cavalli-Sforza 2005)</span>. See <a href="https://cephb.fr/en/hgdp_panel.php" class="external-link">here</a> for more
information.</p>
</div>
<div class="section level2">
<h2 id="data-sources-and-preprocessing">Data Sources and Preprocessing<a class="anchor" aria-label="anchor" href="#data-sources-and-preprocessing"></a>
</h2>
<p>  We use the Harvard HGDP-CEPH data <span class="citation">(Lu et al.
2011)</span>. We download the data in PLINK format from <a href="https://reichdata.hms.harvard.edu/pub/datasets/humanOrigins/Harvard_HGDP-CEPH.tgz" class="external-link">here</a>.
We rename <code>all_snp.map</code> and <code>all_snp.ped</code> to
<code>HGDP.map</code> and <code>HGDP.ped</code>. Then, we use the PLINK
code <code>plink --file HGDP --make-bed --out HGDP</code> to construct
the binary file. We end up with the following file.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>HGDP</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>├── HGDP.bed</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>├── HGDP.bim</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>├── HGDP.fam</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>├── HGDP.map</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>├── HGDP.ped</span></code></pre></div>
<p>  We use the R package <code>genio</code> to read in the PLINK format
document and convert the gene data into a genotype matrix, each element
of which represents the observed number of copies of minor allele at
marker j of person i. The rows of the matrix represent individuals and
the columns of the matrix represent SNPs. Now we preprocess the data. We
first remove the rows with a missing rate greater than 0.5%, and then we
assign the remaining missing values to the mode, which is 0. In order to
ensure the feasibility of the iterative algorithm, we delete rows with
the same row value. We store the processed data as
<code>data_HGDP_full.rda</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/OchoaLab/genio" class="external-link">genio</a></span><span class="op">)</span></span>
<span><span class="co"># Load data HGDP.</span></span>
<span><span class="va">HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genio/man/read_plink.html" class="external-link">read_plink</a></span><span class="op">(</span><span class="st">'HGDP/HGDP.bed'</span><span class="op">)</span></span>
<span><span class="va">data_HGDP_full</span> <span class="op">&lt;-</span> <span class="va">HGDP</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="co"># Filters rows with missing values.</span></span>
<span><span class="va">NA_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Remove rows with more than 0.5% NA.</span></span>
<span><span class="va">data_HGDP_full</span> <span class="op">&lt;-</span> <span class="va">data_HGDP_full</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.005</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co"># Assign the missing value to 0.</span></span>
<span><span class="va">data_HGDP_full</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co"># Delete rows with the same row value.</span></span>
<span><span class="va">same_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">same_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">same_HGDP</span>, <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">data_HGDP_full</span> <span class="op">&lt;-</span> <span class="va">data_HGDP_full</span><span class="op">[</span><span class="op">-</span><span class="va">same_HGDP</span>, <span class="op">]</span></span>
<span><span class="co"># Save data.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">data_HGDP_full</span>, file<span class="op">=</span><span class="st">"data_HGDP_full.rda"</span><span class="op">)</span></span></code></pre></div>
<p>  In order to simplify the data processing and conform to the setting
of the model, we randomly selected 5000 SNPs from the complete data and
transposed the matrix. We stored these data as
<code>data_HGDP.rda</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A random sample of 5000 SNPs.</span></span>
<span><span class="va">data_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span><span class="op">)</span>, <span class="fl">5000</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Save data.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">data_HGDP</span>, file<span class="op">=</span><span class="st">"data_HGDP.rda"</span><span class="op">)</span></span></code></pre></div>
<p>  To make it easier to group the data, we make corresponding tables
<code>HGDP.txt</code> with three columns for individuals and populations
of the HGDP dataset on the basis of document
<code>sample_all_snp.txt</code> and a 2008 paper <span class="citation">(Li et al. 2008)</span>. <code>Superpop</code>
represents large populations, such as Asians, Africans, Europeans.
<code>Pop</code> represents small populations, such as Chinese, British,
Norwegian. <code>Indiv</code> represents individuals.</p>
<p>  We read this table into R and store it as
<code>map_HGDP.rda</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reading a MAP File.</span></span>
<span><span class="va">map_HGDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"HGDP.txt"</span>, header<span class="op">=</span><span class="cn">T</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="co"># Save data.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">map_HGDP</span>, file<span class="op">=</span><span class="st">"map_HGDP.rda"</span><span class="op">)</span></span></code></pre></div>
<p>  <code>data_HGDP.rda</code> and <code>map_HGDP.rda</code> are the
built-in data of AwesomePackage. You can find more information at
<em>Reference</em> in <a href="https://jonathonchow.github.io/AwesomePackage/">AwesomePackage</a>.</p>
</div>
<div class="section level2">
<h2 id="fit-the-data">Fit the Data<a class="anchor" aria-label="anchor" href="#fit-the-data"></a>
</h2>
<p>  We use the following four algorithms to fit the sampled data for
different <code>K</code>, and collect the evaluation indicators of the
fitting results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JONATHONCHOW/AwesomePackage" class="external-link">AwesomePackage</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="em-algorithm">EM algorithm<a class="anchor" aria-label="anchor" href="#em-algorithm"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_em_K2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">2</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [============&gt;--------------------------------------------------] 400/2000 ( 1m)</span></span>
<span><span class="va">result_HGDP_em_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===============&gt;-----------------------------------------------] 500/2000 ( 3m)</span></span>
<span><span class="va">result_HGDP_em_K4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">4</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==============&gt;------------------------------------------------] 480/2000 ( 4m)</span></span>
<span><span class="va">result_HGDP_em_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=======================&gt;---------------------------------------] 750/2000 ( 9m)</span></span>
<span><span class="va">result_HGDP_em_K6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">6</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=========================&gt;-------------------------------------] 830/2000 (13m)</span></span>
<span><span class="va">result_HGDP_em_K7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">7</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=======================================&gt;----------------------] 1300/2000 (27m)</span></span>
<span><span class="va">result_HGDP_em_K8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">8</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===================&gt;-------------------------------------------] 620/2000 (15m)</span></span>
<span><span class="va">result_HGDP_em_K9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">9</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [========================&gt;--------------------------------------] 780/2000 (25m)</span></span>
<span><span class="va">result_HGDP_em_K10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">10</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=========================&gt;-------------------------------------] 830/2000 (34m)</span></span>
<span><span class="va">result_HGDP_em_K11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">11</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;-----------------------------] 1070/2000 ( 1h)</span></span>
<span><span class="va">result_HGDP_em_K12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">12</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [========================&gt;--------------------------------------] 800/2000 (44m)</span></span>
<span><span class="va">result_HGDP_em_K13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">13</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===========================&gt;-----------------------------------] 900/2000 ( 1h)</span></span>
<span><span class="va">result_HGDP_em_K14</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">14</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [===============================&gt;------------------------------] 1020/2000 ( 1h)</span></span>
<span><span class="va">result_HGDP_em_K15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_em.html">psd_fit_em</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">15</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;-----------------------------] 1050/2000 ( 1h)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_em.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="sqp-algorithm">SQP algorithm<a class="anchor" aria-label="anchor" href="#sqp-algorithm"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_sqp_K2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">2</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 (40s)</span></span>
<span><span class="co"># [=========&gt;-------------------------------------------------------] 30/200 (28s)</span></span>
<span><span class="va">result_HGDP_sqp_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 1m)</span></span>
<span><span class="co"># [=========&gt;-------------------------------------------------------] 30/200 ( 1m)</span></span>
<span><span class="va">result_HGDP_sqp_K4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">4</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 2m)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------------] 40/200 ( 2m)</span></span>
<span><span class="va">result_HGDP_sqp_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 2m)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 ( 5m)</span></span>
<span><span class="va">result_HGDP_sqp_K6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">6</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 200/200 ( 3m)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------------] 40/200 ( 5m)</span></span>
<span><span class="va">result_HGDP_sqp_K7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">7</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 500/500 (10m)</span></span>
<span><span class="co"># [=========&gt;-------------------------------------------------------] 30/200 ( 5m)</span></span>
<span><span class="va">result_HGDP_sqp_K8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">8</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 500/500 (13m)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 (12m)</span></span>
<span><span class="va">result_HGDP_sqp_K9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">9</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 500/500 (15m)</span></span>
<span><span class="co"># [===============================================&gt;----------------] 150/200 (44m)</span></span>
<span><span class="va">result_HGDP_sqp_K10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">10</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 500/500 (20m)</span></span>
<span><span class="co"># [============&gt;----------------------------------------------------] 40/200 (15m)</span></span>
<span><span class="va">result_HGDP_sqp_K11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">11</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 500/500 (24m)</span></span>
<span><span class="co"># [==================================&gt;-----------------------------] 110/200 ( 1h)</span></span>
<span><span class="va">result_HGDP_sqp_K12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">12</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 800/800 (44m)</span></span>
<span><span class="co"># [===================&gt;---------------------------------------------] 60/200 (36m)</span></span>
<span><span class="va">result_HGDP_sqp_K13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">13</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 800/800 ( 1h)</span></span>
<span><span class="co"># [=========================&gt;---------------------------------------] 80/200 ( 1h)</span></span>
<span><span class="va">result_HGDP_sqp_K14</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">14</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 800/800 ( 1h)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 (43m)</span></span>
<span><span class="va">result_HGDP_sqp_K15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_sqp.html">psd_fit_sqp</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">15</span>, <span class="fl">1e-5</span>, <span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span></span>
<span><span class="co"># [================================================================] 800/800 ( 1h)</span></span>
<span><span class="co"># [===============&gt;-------------------------------------------------] 50/200 ( 1h)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_sqp.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="vi-algorithm">VI algorithm<a class="anchor" aria-label="anchor" href="#vi-algorithm"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_vi_K2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">2</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;-----------------------------] 1070/2000 ( 3m)</span></span>
<span><span class="va">result_HGDP_vi_K3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">3</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [============&gt;--------------------------------------------------] 410/2000 ( 1m)</span></span>
<span><span class="va">result_HGDP_vi_K4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">4</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [========================&gt;--------------------------------------] 800/2000 ( 3m)</span></span>
<span><span class="va">result_HGDP_vi_K5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">5</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;-----------------------------] 1060/2000 ( 5m)</span></span>
<span><span class="va">result_HGDP_vi_K6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">6</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==============================&gt;--------------------------------] 990/2000 ( 5m)</span></span>
<span><span class="va">result_HGDP_vi_K7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">7</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [============================&gt;----------------------------------] 910/2000 ( 5m)</span></span>
<span><span class="va">result_HGDP_vi_K8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">8</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=============================&gt;---------------------------------] 960/2000 ( 6m)</span></span>
<span><span class="va">result_HGDP_vi_K9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">9</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=================================&gt;----------------------------] 1090/2000 ( 7m)</span></span>
<span><span class="va">result_HGDP_vi_K10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">10</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [=================================&gt;----------------------------] 1090/2000 ( 8m)</span></span>
<span><span class="va">result_HGDP_vi_K11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">11</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [====================================&gt;-------------------------] 1200/2000 ( 9m)</span></span>
<span><span class="va">result_HGDP_vi_K12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">12</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [============================&gt;----------------------------------] 930/2000 ( 8m)</span></span>
<span><span class="va">result_HGDP_vi_K13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">13</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==============================&gt;-------------------------------] 1010/2000 ( 9m)</span></span>
<span><span class="va">result_HGDP_vi_K14</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">14</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [==============================================&gt;---------------] 1520/2000 (14m)</span></span>
<span><span class="va">result_HGDP_vi_K15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_vi.html">psd_fit_vi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">15</span>, <span class="fl">1e-5</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co"># [====================================&gt;-------------------------] 1190/2000 (12m)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_vi.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="svi-algorithm">SVI algorithm<a class="anchor" aria-label="anchor" href="#svi-algorithm"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_svi_K2_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">2</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=========&gt;--------------------------------------------------] 80000/5e+05 ( 8m)</span></span>
<span><span class="va">result_HGDP_svi_K3_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=================&gt;-----------------------------------------] 150000/5e+05 (16m)</span></span>
<span><span class="va">result_HGDP_svi_K4_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">4</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==========================&gt;--------------------------------] 230000/5e+05 (28m)</span></span>
<span><span class="va">result_HGDP_svi_K5_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">5</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==================&gt;----------------------------------------] 160000/5e+05 (22m)</span></span>
<span><span class="va">result_HGDP_svi_K6_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">6</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [===============================&gt;---------------------------] 270000/5e+05 (40m)</span></span>
<span><span class="va">result_HGDP_svi_K7_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">7</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=============&gt;---------------------------------------------] 120000/5e+05 (20m)</span></span>
<span><span class="va">result_HGDP_svi_K8_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">8</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [===========&gt;------------------------------------------------] 1e+05/5e+05 (17m)</span></span>
<span><span class="va">result_HGDP_svi_K9_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">9</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [===================&gt;---------------------------------------] 170000/5e+05 (31m)</span></span>
<span><span class="va">result_HGDP_svi_K10_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">10</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [================================&gt;--------------------------] 280000/5e+05 ( 1h)</span></span>
<span><span class="va">result_HGDP_svi_K11_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">11</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==============&gt;--------------------------------------------] 130000/5e+05 (26m)</span></span>
<span><span class="va">result_HGDP_svi_K12_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">12</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=====================&gt;-------------------------------------] 190000/5e+05 (41m)</span></span>
<span><span class="va">result_HGDP_svi_K13_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">13</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [========================================&gt;------------------] 350000/5e+05 ( 1h)</span></span>
<span><span class="va">result_HGDP_svi_K14_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">14</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==========&gt;-------------------------------------------------] 90000/5e+05 (21m)</span></span>
<span><span class="va">result_HGDP_svi_K15_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="fl">15</span>,</span>
<span>                                         <span class="fl">1e-5</span>, <span class="fl">5e+5</span>, <span class="fl">1e+4</span>, <span class="fl">3</span>,</span>
<span>                                         <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                         <span class="fl">5e-2</span>, <span class="fl">1e-1</span>,</span>
<span>                                         <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [===========================================&gt;---------------] 370000/5e+05 ( 2h)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_svi.RData</code>.</p>
</div>
<div class="section level3">
<h3 id="evaluation-indicators">Evaluation indicators<a class="anchor" aria-label="anchor" href="#evaluation-indicators"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loglikelihood_HGDP_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">error_HGDP_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"result_HGDP_em_K"</span>, <span class="va">i</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">loglikelihood_HGDP_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_em</span>, </span>
<span>                             <span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">error_HGDP_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">error_HGDP_em</span>, </span>
<span>                     <span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loglikelihood_HGDP_sqp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">error_HGDP_sqp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"result_HGDP_sqp_K"</span>, <span class="va">i</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">loglikelihood_HGDP_sqp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_sqp</span>, </span>
<span>                              <span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">error_HGDP_sqp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">error_HGDP_sqp</span>, </span>
<span>                      <span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ELBO_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">loglikelihood_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">error_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"result_HGDP_vi_K"</span>, <span class="va">i</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ELBO_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ELBO_HGDP_vi</span>, </span>
<span>                    <span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">L</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">loglikelihood_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_vi</span>, </span>
<span>                             <span class="fu"><a href="../reference/psd_loglikelihood.html">psd_loglikelihood</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">error_HGDP_vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">error_HGDP_vi</span>, </span>
<span>                     <span class="fu"><a href="../reference/psd_error.html">psd_error</a></span><span class="op">(</span><span class="va">data_HGDP</span>, <span class="va">result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_HGDP</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">5e-2</span>, <span class="fl">5e-2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ind_I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_HGDP</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">1e-1</span>, <span class="fl">1e-1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_HGDP_val</span> <span class="op">&lt;-</span> <span class="va">data_HGDP</span><span class="op">[</span><span class="va">ind_I</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">ind_J</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">loglikelihood_HGDP_svi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">P_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"result_HGDP_svi_K"</span>, <span class="va">i</span>, <span class="st">"_sample"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">P</span><span class="op">[</span><span class="va">ind_I</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>  <span class="va">loglikelihood_HGDP_svi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_svi</span>, </span>
<span>                              <span class="fu"><a href="../reference/psd_loglikelihood_svi.html">psd_loglikelihood_svi</a></span><span class="op">(</span><span class="va">data_HGDP_val</span>, <span class="va">i</span>, <span class="va">P_val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">ind_J</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">ind_I</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">data_HGDP_val</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">P_val</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_evaluate.RData</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="choose-k">Choose <code>K</code><a class="anchor" aria-label="anchor" href="#choose-k"></a>
</h2>
<p>  We import the data directly.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_evaluate.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>  Criteria for choosing <code>K</code>: When there is no obvious gap
in indicators, the smaller <code>K</code> is preferred.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_index_vs_K.html">plot_index_vs_K</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_em</span>, <span class="va">loglikelihood_HGDP_sqp</span>, <span class="va">loglikelihood_HGDP_vi</span><span class="op">)</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, index.id <span class="op">=</span> <span class="st">"loglik"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>  We notice that the log-likelihood curves of EM and SQP have a
continuous upward trend, which is due to the fact that there is no prior
distribution constraint, which is prone to overfitting. The
log-likelihood curves of EM and SQP slow down from <code>K</code> equals
7.</p>
<p>  The log-likelihood curve of VI flattens out from about
<code>K</code> equals 6, and shows that the optimal <code>K</code> is 8
and 11.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_index_vs_K.html">plot_index_vs_K</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">loglikelihood_HGDP_svi</span><span class="op">)</span>, </span>
<span>                <span class="st">"svi"</span>, index.id <span class="op">=</span> <span class="st">"loglik"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>  The log-likelihood curve of SVI is relatively irregular for three
reasons. First, we use different training and validation sets to fit
different <code>K</code>. Although we finally fixed the validation set
when calculating the log-likelihood on the validation set, this was
based on the assumption that the data are equivalent. Second, our
convergence criterion may be relatively loose, resulting in some cases
that do not really converge to the optimal value. Third, the sensitivity
of the algorithm to the initial value leads to large errors in a single
measurement.</p>
<p>  The log-likelihood curve of SVI shows that the optimal
<code>K</code> is 11 and 14, and 8, 9, 10, and 11 are all good choices
for <code>K</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_index_vs_K.html">plot_index_vs_K</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">error_HGDP_em</span>, <span class="va">error_HGDP_sqp</span>, <span class="va">error_HGDP_vi</span><span class="op">)</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, index.id <span class="op">=</span> <span class="st">"error"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>  The error curves of EM, SQP and VI are almost identical with the
log-likelihood curves of EM, SQP and VI. This is because the error
function is computed based on the entire training set. The way to make
it meaningful is to compute the error function on the validation set
(which is not involved in training) and then evaluate the algorithm
using either normal validation or cross validation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_index_vs_K.html">plot_index_vs_K</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ELBO_HGDP_vi</span><span class="op">)</span>, </span>
<span>                <span class="st">"vi"</span>, index.id <span class="op">=</span> <span class="st">"elbo"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>  The ELBO curve of VI shows the curve oscillating from
<code>K</code> equals 7.</p>
<p>  In conclusion, we note that when <code>K</code> is around 7, the
fit is already doing very well. The optimal <code>K</code> should be
reached around 11, but from the structure diagram, the populations
appear redundant at this time.</p>
</div>
<div class="section level2">
<h2 id="full-data">Full Data<a class="anchor" aria-label="anchor" href="#full-data"></a>
</h2>
<p>  We only fit the complete data for the relatively good
<code>K</code> using SVI algorithm.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_svi_K7_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">7</span>,</span>
<span>                                       <span class="fl">1e-5</span>, <span class="fl">1e+6</span>, <span class="fl">1e+4</span>, <span class="fl">5</span>,</span>
<span>                                       <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                       <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                       <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [======&gt;----------------------------------------------------] 120000/1e+06 (24m)</span></span>
<span><span class="va">result_HGDP_svi_K8_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">8</span>,</span>
<span>                                       <span class="fl">1e-5</span>, <span class="fl">1e+6</span>, <span class="fl">1e+4</span>, <span class="fl">5</span>,</span>
<span>                                       <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                       <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                       <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [======&gt;----------------------------------------------------] 120000/1e+06 (25m)</span></span>
<span><span class="va">result_HGDP_svi_K9_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">9</span>,</span>
<span>                                       <span class="fl">1e-5</span>, <span class="fl">1e+6</span>, <span class="fl">1e+4</span>, <span class="fl">5</span>,</span>
<span>                                       <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                       <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                       <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==================&gt;----------------------------------------] 320000/1e+06 ( 1h)</span></span>
<span><span class="va">result_HGDP_svi_K10_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">10</span>,</span>
<span>                                       <span class="fl">1e-5</span>, <span class="fl">1e+6</span>, <span class="fl">1e+4</span>, <span class="fl">5</span>,</span>
<span>                                       <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                       <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                       <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [==============&gt;--------------------------------------------] 250000/1e+06 ( 1h)</span></span>
<span><span class="va">result_HGDP_svi_K11_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">11</span>,</span>
<span>                                       <span class="fl">1e-5</span>, <span class="fl">1e+6</span>, <span class="fl">1e+4</span>, <span class="fl">5</span>,</span>
<span>                                       <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                       <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                       <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [=====&gt;-----------------------------------------------------] 110000/1e+06 (29m)</span></span></code></pre></div>
<p>  In addition, we iterated for a million times for the case of the
<strong>best</strong> <code>K</code> (equals 7 and 11).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_HGDP_svi_K7_full_million</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">7</span>,</span>
<span>                                               <span class="fl">1e-9</span>, <span class="fl">1e+6</span>, <span class="fl">1e+5</span>, <span class="fl">10</span>,</span>
<span>                                               <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                               <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                               <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [============================================================] 1e+06/1e+06 ( 3h)</span></span>
<span><span class="va">result_HGDP_svi_K11_full_million</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psd_fit_svi.html">psd_fit_svi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data_HGDP_full</span><span class="op">)</span>, <span class="fl">11</span>,</span>
<span>                                               <span class="fl">1e-9</span>, <span class="fl">1e+6</span>, <span class="fl">1e+5</span>, <span class="fl">10</span>,</span>
<span>                                               <span class="fl">100</span>, <span class="fl">2000</span>,</span>
<span>                                               <span class="fl">5e-3</span>, <span class="fl">1e-1</span>,</span>
<span>                                               <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co"># [============================================================] 1e+06/1e+06 ( 4h)</span></span></code></pre></div>
<p>  We store the result as <code>result_HGDP_full.RData</code>. Then we
import the data directly.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_full.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_HGDP</span><span class="op">)</span></span>
<span><span class="va">lpop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">spop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">indiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">map_HGDP</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K7_full</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K8_full</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI | K: 8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K9_full</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI | K: 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K10_full</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI | K: 10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K11_full</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI | K: 11"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-23-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-23-2.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-23-3.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-23-4.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-23-5.png" width="864"></p>
<p>  For the <strong>best</strong> <code>K</code> (equals 7 and 11), we
draw more subtle structures. We can compare with the results in the
articles <span class="citation">(Li et al. 2008; Raj, Stephens, and
Pritchard 2014; Gopalan et al. 2016)</span>, and the structure diagram
is almost the same.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K7_full_million</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">spop</span>, gap <span class="op">=</span> <span class="fl">2</span>, font.size <span class="op">=</span> <span class="fl">6</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI (1e+6 interations) | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K11_full_million</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">spop</span>, gap <span class="op">=</span> <span class="fl">2</span>, font.size <span class="op">=</span> <span class="fl">6</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP (full) | Method: SVI (1e+6 interations) | K: 11"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-24-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-24-2.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="algorithm-evaluation">Algorithm Evaluation<a class="anchor" aria-label="anchor" href="#algorithm-evaluation"></a>
</h2>
<div class="section level3">
<h3 id="convergence-accuracy">Convergence accuracy<a class="anchor" aria-label="anchor" href="#convergence-accuracy"></a>
</h3>
<p>  For suitable <code>K</code>, the SVI algorithm and SQP algorithm
perform best in terms of convergence accuracy, followed by VI algorithm
and finally EM algorithm. See <em>Get started</em> in <a href="https://jonathonchow.github.io/AwesomePackage/">AwesomePackage</a>
for details.</p>
<p>  For the unknown <code>K</code>, due to the lack of prior
constraints, the EM algorithm and SQP algorithm are prone to overfitting
when the population number is redundant. We can see this clearly in <a href="#AppendixB">Appendix B</a>. Therefore, we had better use VI
algorithm and SVI algorithm to select the appropriate
<code>K</code>.</p>
</div>
<div class="section level3">
<h3 id="convergence-efficiency">Convergence efficiency<a class="anchor" aria-label="anchor" href="#convergence-efficiency"></a>
</h3>
<p>  In addition to measuring the accuracy of convergence, we still need
to consider the efficiency of convergence. We have two indicators to
measure the convergence efficiency, which are convergence speed (the
number of iterations required to achieve convergence) and convergence
time (the time required for a single iteration). We can plot the
convergence time using the code below, and we can see the convergence
speed plots in <a href="#AppendixA">Appendix A</a>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">9</span>,<span class="fl">13</span>,<span class="fl">27</span>,<span class="fl">15</span>,<span class="fl">25</span>,<span class="fl">34</span>,<span class="fl">60</span>,<span class="fl">44</span>,<span class="fl">60</span>,<span class="fl">60</span>,<span class="fl">60</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">15</span>,<span class="fl">25</span>,<span class="fl">59</span>,<span class="fl">35</span>,<span class="fl">84</span>,<span class="fl">80</span>,<span class="fl">120</span>,<span class="fl">103</span>,<span class="fl">120</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">12</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">16</span>,<span class="fl">28</span>,<span class="fl">22</span>,<span class="fl">40</span>,<span class="fl">20</span>,<span class="fl">17</span>,<span class="fl">31</span>,<span class="fl">60</span>,<span class="fl">26</span>,<span class="fl">41</span>,<span class="fl">60</span>,<span class="fl">21</span>,<span class="fl">120</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_index_vs_K.html">plot_index_vs_K</a></span><span class="op">(</span><span class="va">L</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"sqp"</span>, <span class="st">"vi"</span>, <span class="st">"svi"</span><span class="op">)</span>, index.id <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>                title <span class="op">=</span> <span class="st">"Data Set: HGDP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>  EM algorithm is poor in terms of convergence time and convergence
speed, and the convergence time increases rapidly with the increase of
<code>K</code>.</p>
<p>  Although SQP algorithm has a good performance in terms of
convergence speed, the convergence time of the unaccelerated SQP
algorithm is extremely slow, which increases rapidly with the increase
of <code>K</code>.</p>
<p>  VI algorithm has similar convergence speed with EM algorithm (both
of them have poor performance), but in terms of convergence time, VI
algorithm has excellent performance, especially with the increase of
<code>K</code>, the required time increases slowly.</p>
<p>  Due to different principles, we only consider the convergence time
for the SVI algorithm. Although the performance of convergence time of
SVI algorithm is poor on small data sets, the time of SVI algorithm is
almost only related to the length of single sampling (the number of
individuals), that is to say, for complete data sets, the convergence
time of SVI is almost unchanged. This means that SVI has irreplaceable
advantages for large data sets. Meanwhile, similar to VI algorithm, the
change of convergence time of SVI algorithm is relatively insensitive to
<code>K</code>. By the way, compared with other algorithms, the
convergence time of SVI algorithm is irregular due to the randomness of
sampling.</p>
</div>
<div class="section level3">
<h3 id="algorithm-selection-criteria">Algorithm selection criteria<a class="anchor" aria-label="anchor" href="#algorithm-selection-criteria"></a>
</h3>
<p>  In conclusion, we should consider both algorithm accuracy and
algorithm efficiency.</p>
<p>  For small data sets, we can get good results by using VI directly.
Or we can first use VI algorithm to reach the vicinity of the optimal
value, and then use SQP algorithm to improve the convergence accuracy.
The reason why the SQP algorithm is not directly used here is that the
unaccelerated SQP algorithm is inefficient and the SQP algorithm is
extremely easy to converge to local minima.</p>
<p>  For large data sets, we use the SVI algorithm without question.</p>
<p>  Of course, if <code>K</code> is unknown, we should pick
<code>K</code> first, in the same way as above.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="literature-cited">Literature Cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cann2002human" class="csl-entry">
Cann, Howard M, Claudia De Toma, Lucien Cazes, Marie-Fernande Legrand,
Valerie Morel, Laurence Piouffre, Julia Bodmer, et al. 2002. <span>“A
Human Genome Diversity Cell Line Panel.”</span> <em>Science</em> 296
(5566): 261–62.
</div>
<div id="ref-cavalli2005human" class="csl-entry">
Cavalli-Sforza, L Luca. 2005. <span>“The Human Genome Diversity Project:
Past, Present and Future.”</span> <em>Nature Reviews Genetics</em> 6
(4): 333–40.
</div>
<div id="ref-gopalan2016scaling" class="csl-entry">
Gopalan, Prem, Wei Hao, David M Blei, and John D Storey. 2016.
<span>“Scaling Probabilistic Models of Genetic Variation to Millions of
Humans.”</span> <em>Nature Genetics</em> 48 (12): 1587–90.
</div>
<div id="ref-li2008worldwide" class="csl-entry">
Li, Jun Z, Devin M Absher, Hua Tang, Audrey M Southwick, Amanda M Casto,
Sohini Ramachandran, Howard M Cann, et al. 2008. <span>“Worldwide Human
Relationships Inferred from Genome-Wide Patterns of Variation.”</span>
<em>Science</em> 319 (5866): 1100–1104.
</div>
<div id="ref-lu2011technical" class="csl-entry">
Lu, Yontao, Nick Patterson, Yiping Zhan, Swapan Mallick, and David
Reich. 2011. <span>“Technical Design Document for a SNP Array That Is
Optimized for Population Genetics.”</span>
</div>
<div id="ref-raj2014faststructure" class="csl-entry">
Raj, Anil, Matthew Stephens, and Jonathan K Pritchard. 2014.
<span>“fastSTRUCTURE: Variational Inference of Population Structure in
Large SNP Data Sets.”</span> <em>Genetics</em> 197 (2): 573–89.
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="AppendixA">Appendix A<a class="anchor" aria-label="anchor" href="#AppendixA"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_em.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_sqp.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_vi.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"result_HGDP_svi.RData"</span>, package <span class="op">=</span> <span class="st">"AwesomePackage"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K2</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K2</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K2</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K2_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-2.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K3</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K3</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K3</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-3.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K3_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-4.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K4</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K4</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K4</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-5.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K4_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-6.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K5</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K5</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K5</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-7.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K5_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 5"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-8.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K6</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K6</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K6</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 6"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-9.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K6_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 6"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-10.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K7</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K7</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K7</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 7"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-11.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K7_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 7"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-12.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K8</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K8</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K8</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 8"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-13.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K8_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 8"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-14.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K9</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K9</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K9</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 9"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-15.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K9_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 9"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-16.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K10</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K10</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K10</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 10"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-17.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K10_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 10"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-18.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K11</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K11</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K11</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 11"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-19.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K11_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 11"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-20.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K12</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K12</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K12</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 12"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-21.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K12_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 12"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-22.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K13</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K13</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K13</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 13"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-23.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K13_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 13"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-24.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K14</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K14</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K14</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 14"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-25.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K14_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 14"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-26.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_em_K15</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result_HGDP_sqp_K15</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               <span class="va">result_HGDP_vi_K15</span><span class="op">$</span><span class="va">Loss</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"em"</span>, <span class="st">"em &amp; sqp"</span>, <span class="st">"vi"</span><span class="op">)</span>, <span class="fl">10</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-27.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loss.html">plot_loss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K15_sample</span><span class="op">$</span><span class="va">Loss</span><span class="op">)</span>, <span class="st">"svi"</span>, <span class="fl">1e+4</span>, </span>
<span>          title <span class="op">=</span> <span class="st">"Data Set: HGDP | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-27-28.png" width="700"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="AppendixB">Appendix B<a class="anchor" aria-label="anchor" href="#AppendixB"></a>
</h2>
<div class="section level3">
<h3 class="unnumbered" id="em-algorithm-1">EM algorithm<a class="anchor" aria-label="anchor" href="#em-algorithm-1"></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K2</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K3</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K4</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K5</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K6</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K7</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K8</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K9</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K10</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K11</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 11"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K12</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 12"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K13</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 13"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K14</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 14"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_em_K15</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: EM | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-2.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-3.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-4.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-5.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-6.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-7.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-8.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-9.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-10.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-11.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-12.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-13.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-28-14.png" width="864"></p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="sqp-algorithm-1">SQP algorithm<a class="anchor" aria-label="anchor" href="#sqp-algorithm-1"></a>
</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K2</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K3</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K4</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K5</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K6</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K7</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K8</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K9</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K10</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K11</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 11"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K12</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 12"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K13</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 13"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K14</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 14"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_sqp_K15</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SQP | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-2.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-3.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-4.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-5.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-6.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-7.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-8.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-9.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-10.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-11.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-12.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-13.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-29-14.png" width="864"></p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="vi-algorithm-1">VI algorithm<a class="anchor" aria-label="anchor" href="#vi-algorithm-1"></a>
</h3>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K2</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K3</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K4</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K5</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K6</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K7</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K8</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K9</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K10</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K11</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 11"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K12</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 12"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K13</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 13"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K14</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 14"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_vi_K15</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: VI | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-2.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-3.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-4.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-5.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-6.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-7.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-8.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-9.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-10.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-11.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-12.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-13.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-30-14.png" width="864"></p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="svi-algorithm-1">SVI algorithm<a class="anchor" aria-label="anchor" href="#svi-algorithm-1"></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K2_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K3_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K4_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K5_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K6_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K7_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K8_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K9_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K10_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 10"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K11_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 11"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K12_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 12"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K13_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 13"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K14_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 14"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">result_HGDP_svi_K15_sample</span><span class="op">$</span><span class="va">P</span>, </span>
<span>               label <span class="op">=</span> <span class="va">label</span>, map.indiv <span class="op">=</span> <span class="va">indiv</span>, map.pop <span class="op">=</span> <span class="va">lpop</span>, gap <span class="op">=</span> <span class="fl">5</span>, </span>
<span>               title <span class="op">=</span> <span class="st">"Data Set: HGDP | Method: SVI | K: 15"</span><span class="op">)</span></span></code></pre></div>
<p><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-1.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-2.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-3.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-4.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-5.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-6.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-7.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-8.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-9.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-10.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-11.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-12.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-13.png" width="864"><img src="12_application_hgdp_files/figure-html/unnamed-chunk-31-14.png" width="864"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonathon Chow.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
