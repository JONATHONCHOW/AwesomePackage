[{"path":"https://jonathonchow.github.io/AwesomePackage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 AwesomePackage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"psd-model-and-data","dir":"Articles","previous_headings":"","what":"PSD model and data","title":"Fit PSD model","text":"consider first chromosome data 1000 Genomes Project (TGP) use PSD model fit data.","code":"library(AwesomePackage) data(data_TGP)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-em-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by EM algorithm","title":"Fit PSD model","text":"fit PSD model EM algorithm, use loss function stopping criterion. EM algorithm converges slowly. takes 450 EM iterations reach predetermined accuracy. addition, fitting result EM algorithm accurate. import pre-trained results directly. plot loss function number iterations using package ggplot2, loss function records 10 iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_TGP_em <- psd_fit_em(data_TGP, 3, 1e-5, 500) data(result_TGP_em) L <- result_TGP_em$Loss plot_loss(L, 10, \"em\") P <- result_TGP_em$P pops <- order(colMeans(P)) colors <- c(\"#E69F00\", \"#56B4E9\", \"#009E73\") plot_structure(P, pops, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-sqp-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by SQP algorithm","title":"Fit PSD model","text":"fit PSD model SQP algorithm, use loss function stopping criterion. Although SQP algorithm converges fast, easy converge local optimal value. prevent bad scenario, start 100 EM iterations, need 30 SQP iterations reach accuracy requirement. Notice fitting result SQP algorithm excellent. import pre-trained results directly. plot loss function number iterations using package ggplot2, loss function records 10 iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_TGP_sqp <- psd_fit_sqp(data_TGP, 3, 1e-5, 50, 100) data(result_TGP_sqp) L <- result_TGP_sqp$Loss plot_loss(L, 10, \"sqp\") P <- result_TGP_sqp$P pops <- order(colMeans(P)) colors <- c(\"#E69F00\", \"#56B4E9\", \"#009E73\") plot_structure(P, pops, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-vi-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by VI algorithm","title":"Fit PSD model","text":"fit PSD model VI algorithm, use loss function stopping criterion. Similar EM algorithm, convergence VI algorithm also relatively slow, 440 iterations needed reach accuracy requirement. fitting result much better EM algorithm. import pre-trained results directly. plot loss function number iterations using package ggplot2, loss function records 10 iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_TGP_vi <- psd_fit_vi(data_TGP, 3, 1e-5, 500) data(result_TGP_vi) L <- result_TGP_vi$Loss plot_loss(L, 10, \"vi\") P <- result_TGP_vi$P pops <- order(colMeans(P)) colors <- c(\"#E69F00\", \"#56B4E9\", \"#009E73\") plot_structure(P, pops, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathon Chow. Author, maintainer.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chow J (2022). AwesomePackage: Infer ancestry models fit models algorithms. https://github.com/JONATHONCHOW/AwesomePackage, https://jonathonchow.github.io/AwesomePackage/.","code":"@Manual{,   title = {AwesomePackage: Infer ancestry with some models and fit those models with some algorithms},   author = {Jonathon Chow},   year = {2022},   note = {https://github.com/JONATHONCHOW/AwesomePackage, https://jonathonchow.github.io/AwesomePackage/}, }"},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"awesomepackage","dir":"","previous_headings":"","what":"Infer ancestry with some models and fit those models with some algorithms","title":"Infer ancestry with some models and fit those models with some algorithms","text":"goal AwesomePackage infer ancestry models fit models algorithms. use classical PSD model ancestor inference, widely used, STRUCTURE (Pritchard et al. 2000, MCMC), FRAPPE (Tang et al. 2005, EM), ADMIXTURE (Alexander et al. 2009, SQP), fastSTRUCTURE (Raj et al. 2014, VI), TeraStructure (Gopalan et al. 2017, SVI). illustrate close relationship PSD model, Poisson NMF model, multinomial topic model LDA model, can optimize algorithm. use Expectation-Maximization algorithm (EM), sequential quadratic programming algorithm (SQP), variational inference algorithm (VI) stochastic variational inference algorithm (SVI) fit model, illustrate relationships differences algorithms simulation experiments real data experiments.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Infer ancestry with some models and fit those models with some algorithms","text":"can install development version AwesomePackage GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"JONATHONCHOW/AwesomePackage\")"},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Infer ancestry with some models and fit those models with some algorithms","text":"can check theories examples Articles AwesomePackage.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Infer ancestry with some models and fit those models with some algorithms","text":"can use following code see AwesomePackage successfully installed. can refer Reference AwesomePackage use functions, can fun ancestry inference!","code":"library(AwesomePackage) hello_world() #> [1] \"Data science is fantastic!\""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/data_TGP.html","id":null,"dir":"Reference","previous_headings":"","what":"First chromosome data from the 1000 Genomes Project — data_TGP","title":"First chromosome data from the 1000 Genomes Project — data_TGP","text":"1000 Genomes Project (TGP) created catalogue common human genetic variation, using openly consented samples people declared healthy. reference data resources generated project remain heavily used biomedical science community. International Genome Sample Resource (IGSR) maintains shares human genetic variation resources built 1000 Genomes Project. also update resources current reference assembly, add new data sets generated 1000 Genomes Project samples add data projects working openly consented samples.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/data_TGP.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"First chromosome data from the 1000 Genomes Project — data_TGP","text":"data_TGP 1092 x 50000 matrix.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/data_TGP.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"First chromosome data from the 1000 Genomes Project — data_TGP","text":"https://www.internationalgenome.org/","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":null,"dir":"Reference","previous_headings":"","what":"Hello world — hello_world","title":"Hello world — hello_world","text":"Hello world add \"AwesomePackage\" NAMESPACE.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hello world — hello_world","text":"","code":"hello_world()"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hello world — hello_world","text":"string \"Data science fantastic!\".","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hello world — hello_world","text":"","code":"hello_world() #> [1] \"Data science is fantastic!\""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_loss.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the loss function — plot_loss","title":"Plot the loss function — plot_loss","text":"Plot loss function number iterations using package ggplot2.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_loss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the loss function — plot_loss","text":"","code":"plot_loss(   L,   sample.rate,   method,   epsilon = 0.01,   colors = c(\"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\"),   linetypes = \"solid\",   linesizes = 0.5,   shapes = 19,   fills = \"white\",   theme = function() theme_cowplot(12) )"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_loss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the loss function — plot_loss","text":"L vector represents loss function. sample.rate sampling rate loss function. method name fitting algorithm, \"em\", \"sqp\", \"vi\", \"svi\". epsilon small, positive number added vertical axis logarithmic scale -emphasize small differences. colors colors used draw loss curves. linetypes line types used draw loss curves. linesizes line sizes used draw loss curves. shapes shapes used draw points selected iterations. fills fill colors used draw points selected iterations. theme ‘ggplot2’ “theme”.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_loss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the loss function — plot_loss","text":"ggplot object.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_loss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the loss function — plot_loss","text":"","code":"L <- c(-100,-20,-10,-1,-0.5,-0.3,-0.1) plot_loss(L, 1, \"fun\")"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_structure.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the population proportion — plot_structure","title":"Plot the population proportion — plot_structure","text":"Plot population proportion individuals using package ggplot2.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_structure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the population proportion — plot_structure","text":"","code":"plot_structure(P, pops, colors, ticks = NULL, font.size = 9)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_structure.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the population proportion — plot_structure","text":"P proportion matrix. pops Population order options. colors Theme color options. ticks Grouping options. font.size Font size used plot.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_structure.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the population proportion — plot_structure","text":"ggplot object.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/plot_structure.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the population proportion — plot_structure","text":"","code":"P <- matrix(c(0.5,0.3,0.8, 0.5,0.7,0.2), 3, 2) pops <- order(colMeans(P)) colors <- c(\"red\", \"yellow\") plot_structure(P, pops, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Use EM algorithm to fit PSD model — psd_fit_em","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"Fit PSD model EM algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"","code":"psd_fit_em(G, K, epsilon = 1e-05, maxiter = 500)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector represents value loss function records 10 iterations. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_em(G, 2, 1e-5, 10) #> $P #>             [,1]      [,2] #> [1,] 0.962090397 0.0379096 #> [2,] 0.001503173 0.9984968 #> [3,] 0.734674000 0.2653260 #>  #> $F #>              [,1]       [,2]         [,3]         [,4]         [,5] #> [1,] 2.806361e-01 0.03464942 5.794294e-01 6.060589e-20 3.063564e-01 #> [2,] 1.852751e-07 0.99999940 3.681348e-06 4.185755e-01 4.262692e-08 #>  #> $Loss #> [1] -1.7792612 -0.7161612 #>  #> $Iterations #> [1] 10 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":null,"dir":"Reference","previous_headings":"","what":"Use SQP algorithm to fit PSD model — psd_fit_sqp","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"Fit PSD model SQP algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"","code":"psd_fit_sqp(G, K, epsilon = 1e-05, maxiter = 50, initem = 100)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations. initem number iterations using EM algorithm initialization.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector represents value loss function records 10 iterations. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_sqp(G, 2, 1e-5, 10, 1) #> $P #>             [,1]        [,2] #> [1,] 0.000000001 0.999999999 #> [2,] 0.999999999 0.000000001 #> [3,] 0.311467392 0.688532608 #>  #> $F #>             [,1]  [,2]        [,3]        [,4]        [,5] #> [1,] 0.000000001 1e+00 0.000000001 0.413310782 0.000000001 #> [2,] 0.276605168 1e-09 0.573877879 0.000000001 0.311841591 #>  #> $Loss #> [1] -1.0350784 -0.7074249 #>  #> $Iterations #> [1] 10 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":null,"dir":"Reference","previous_headings":"","what":"Use VI algorithm to fit PSD model — psd_fit_vi","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"Fit PSD model VI algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"","code":"psd_fit_vi(G, K, epsilon = 1e-05, maxiter = 500)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector represents value loss function records 10 iterations. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_vi(G, 2, 1e-5, 10) #> $P #>           [,1]      [,2] #> [1,] 0.5217157 0.4782843 #> [2,] 0.4477954 0.5522046 #> [3,] 0.4953914 0.5046086 #>  #> $F #>           [,1]      [,2]      [,3]      [,4]      [,5] #> [1,] 0.3065270 0.4670645 0.4196722 0.2902633 0.3151805 #> [2,] 0.2936995 0.5319241 0.3810271 0.3094928 0.2854207 #>  #> $Loss #> [1] -3.217136 -1.796784 #>  #> $Iterations #> [1] 10 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of data_TGP by EM algorithm — result_TGP_em","title":"Pre-training result of data_TGP by EM algorithm — result_TGP_em","text":"result following code: psd_fit_em(data_TGP, 3, 1e-5, 500).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_em.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of data_TGP by EM algorithm — result_TGP_em","text":"result_TGP_em list four elements.","code":""},{"path":[]},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_sqp.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of data_TGP by SQP algorithm — result_TGP_sqp","title":"Pre-training result of data_TGP by SQP algorithm — result_TGP_sqp","text":"result following code: psd_fit_sqp(data_TGP, 3, 1e-5, 50, 100).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_sqp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of data_TGP by SQP algorithm — result_TGP_sqp","text":"result_TGP_sqp list four elements.","code":""},{"path":[]},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_vi.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of data_TGP by VI algorithm — result_TGP_vi","title":"Pre-training result of data_TGP by VI algorithm — result_TGP_vi","text":"result following code: psd_fit_vi(data_TGP, 3, 1e-5, 500).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_TGP_vi.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of data_TGP by VI algorithm — result_TGP_vi","text":"result_TGP_vi list four elements.","code":""},{"path":[]}]
