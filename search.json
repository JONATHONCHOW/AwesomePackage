[{"path":"https://jonathonchow.github.io/AwesomePackage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 AwesomePackage authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"psd-model-and-data","dir":"Articles","previous_headings":"","what":"PSD model and data","title":"Fit PSD model","text":"consider first chromosome data 1000 Genomes Project use PSD model fit data.","code":"library(AwesomePackage) data(genome_chr1)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-em-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by EM algorithm","title":"Fit PSD model","text":"fit PSD model EM algorithm, use loss function stopping criterion. import pre-trained results. plot loss function number iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_em <- psd_fit_em(genome_chr1, 3, 1e-3, 500) data(result_em) L_em <- result_em$\"Loss\" plot(L_em) P_em <- result_em$\"P\" topics <- order(colMeans(P_em)) colors <- c(\"red\", \"yellow\", \"blue\") structure_plot(P_em, topics, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-sqp-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by SQP algorithm","title":"Fit PSD model","text":"fit PSD model SQP algorithm, use loss function stopping criterion. import pre-trained results. plot loss function number iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_sqp <- psd_fit_sqp(genome_chr1, 3, 1e-3, 500, 100) data(result_sqp) L_sqp <- result_sqp$\"Loss\" plot(L_sqp) P_sqp <- result_sqp$\"P\" topics <- order(colMeans(P_sqp)) colors <- c(\"red\", \"yellow\", \"blue\") structure_plot(P_sqp, topics, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/articles/psd_fit.html","id":"fit-psd-model-by-vi-algorithm","dir":"Articles","previous_headings":"","what":"Fit PSD model by VI algorithm","title":"Fit PSD model","text":"fit PSD model VI algorithm, use loss function stopping criterion. Due different calculation methods loss function, value epsilon needs smaller previous two algorithms. import pre-trained results. plot loss function number iterations. Different previous two algorithms, loss function records ten iterations.  plot ancestral proportions individuals using package ggplot2.","code":"result_vi <- psd_fit_vi(genome_chr1, 3, 1e-9, 500) data(result_vi) L_vi <- result_vi$Loss plot(L_vi) P_vi <- result_vi$P topics <- order(colMeans(P_vi)) colors <- c(\"red\", \"yellow\", \"blue\") structure_plot(P_vi, topics, colors)"},{"path":"https://jonathonchow.github.io/AwesomePackage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathon Chow. Author, maintainer.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Chow J (2022). AwesomePackage: Infer ancestry models fit models algorithms. https://github.com/JONATHONCHOW/AwesomePackage, https://jonathonchow.github.io/AwesomePackage/.","code":"@Manual{,   title = {AwesomePackage: Infer ancestry with some models and fit those models with some algorithms},   author = {Jonathon Chow},   year = {2022},   note = {https://github.com/JONATHONCHOW/AwesomePackage, https://jonathonchow.github.io/AwesomePackage/}, }"},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"awesomepackage","dir":"","previous_headings":"","what":"Infer ancestry with some models and fit those models with some algorithms","title":"Infer ancestry with some models and fit those models with some algorithms","text":"goal AwesomePackage infer ancestry models fit models algorithms. use classical PSD model ancestor inference, widely used, STRUCTURE (Pritchard et al. 2000, MCMC), FRAPPE (Tang et al. 2005, EM), ADMIXTURE (Alexander et al. 2009, SQP), fastSTRUCTURE (Raj et al. 2014, VI), TeraStructure (Gopalan et al. 2017, SVI). illustrate close relationship PSD model, Poisson NMF model, multinomial topic model LDA model, can optimize algorithm. use Expectation-Maximization algorithm (EM), sequential quadratic programming algorithm (SQP), variational inference algorithm (VI) stochastic variational inference algorithm (SVI) fit model, illustrate relationships differences algorithms simulation experiments real data experiments.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Infer ancestry with some models and fit those models with some algorithms","text":"can install development version AwesomePackage GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"JONATHONCHOW/AwesomePackage\")"},{"path":"https://jonathonchow.github.io/AwesomePackage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Infer ancestry with some models and fit those models with some algorithms","text":"can see examples Vignettes.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/genome_chr1.html","id":null,"dir":"Reference","previous_headings":"","what":"First chromosome data from the 1000 Genomes Project — genome_chr1","title":"First chromosome data from the 1000 Genomes Project — genome_chr1","text":"1000 Genomes Project created catalogue common human genetic variation, using openly consented samples people declared healthy. reference data resources generated project remain heavily used biomedical science community. International Genome Sample Resource (IGSR) maintains shares human genetic variation resources built 1000 Genomes Project. also update resources current reference assembly, add new data sets generated 1000 Genomes Project samples add data projects working openly consented samples.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/genome_chr1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"First chromosome data from the 1000 Genomes Project — genome_chr1","text":"genome_chr1 1092 x 50000 matrix.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/genome_chr1.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"First chromosome data from the 1000 Genomes Project — genome_chr1","text":"https://www.internationalgenome.org/","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":null,"dir":"Reference","previous_headings":"","what":"Hello world — hello_world","title":"Hello world — hello_world","text":"Hello world add \"AwesomePackage\" NAMESPACE.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hello world — hello_world","text":"","code":"hello_world()"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hello world — hello_world","text":"string \"Data science fantastic!\".","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/hello_world.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hello world — hello_world","text":"","code":"hello_world() #> [1] \"Data science is fantastic!\""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Use EM algorithm to fit PSD model — psd_fit_em","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"Fit PSD model EM algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"","code":"psd_fit_em(G, K, epsilon = 0.1, maxiter = 500)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector length Iterations + 1 represents value loss function iteration. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_em.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use EM algorithm to fit PSD model — psd_fit_em","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_em(G, 2, 1e-1, 10) #> $P #>            [,1]       [,2] #> [1,] 0.90383650 0.09616350 #> [2,] 0.01121795 0.98878205 #> [3,] 0.93495017 0.06504983 #>  #> $F #>              [,1]      [,2]         [,3]         [,4]       [,5] #> [1,] 2.786593e-01 0.2074244 5.508593e-01 8.417177e-13 0.26760017 #> [2,] 2.841728e-13 0.9982001 2.742101e-05 4.562759e-01 0.00515902 #>  #> $Loss #>  [1] -40.87684 -15.36837 -14.46529 -14.00060 -13.54761 -13.08535 -12.61372 #>  [8] -12.14082 -11.71460 -11.39558 -11.19235 #>  #> $Iterations #> [1] 10 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":null,"dir":"Reference","previous_headings":"","what":"Use SQP algorithm to fit PSD model — psd_fit_sqp","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"Fit PSD model SQP algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"","code":"psd_fit_sqp(G, K, epsilon = 0.1, maxiter = 500, initem = 10)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations. initem number iterations using EM algorithm initialization.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector length Iterations + 1 represents value loss function iteration. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_sqp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use SQP algorithm to fit PSD model — psd_fit_sqp","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_sqp(G, 2, 1e-1, 10, 1) #> $P #>             [,1]        [,2] #> [1,] 0.999999999 0.000000001 #> [2,] 0.000000001 0.999999999 #> [3,] 0.680876636 0.319123364 #>  #> $F #>             [,1]  [,2]        [,3]        [,4]        [,5] #> [1,] 0.277268088 1e-09 0.575496388 0.000000001 0.313141383 #> [2,] 0.000000001 1e+00 0.000000001 0.403292187 0.000000001 #>  #> $Loss #> [1] -15.84913 -10.63861 -10.61220 #>  #> $Iterations #> [1] 2 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":null,"dir":"Reference","previous_headings":"","what":"Use VI algorithm to fit PSD model — psd_fit_vi","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"Fit PSD model VI algorithm, use loss function stopping criterion.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"","code":"psd_fit_vi(G, K, epsilon = 0.1, maxiter = 500)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"G x J matrix counts; entries G taken {0,1,2}. K integer 2 greater giving matrix rank. epsilon Convergence criterion. maxiter maximum number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"List following parameters: P population scale matrix individuals. F gene scale matrix populations. Loss vector represents value loss function records ten iterations. Iterations integer represents number iterations.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/psd_fit_vi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use VI algorithm to fit PSD model — psd_fit_vi","text":"","code":"G <- matrix(c(0,0,1, 0,2,1, 1,0,1, 0,1,0, 1,0,0), 3, 5) psd_fit_vi(G, 2, 1e-1, 10) #> $P #>           [,1]      [,2] #> [1,] 0.5606467 0.4393533 #> [2,] 0.4547072 0.5452928 #> [3,] 0.4775564 0.5224436 #>  #> $F #>           [,1]      [,2]      [,3]      [,4]      [,5] #> [1,] 0.2905237 0.4516174 0.4161201 0.2876922 0.3238803 #> [2,] 0.3094902 0.5480939 0.3840319 0.3123240 0.2766244 #>  #> $Loss #> [1] -3.201112 -1.794875 #>  #> $Iterations #> [1] 10 #>"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of genome_chr1 by EM algorithm — result_em","title":"Pre-training result of genome_chr1 by EM algorithm — result_em","text":"result following code: psd_fit_em(genome_chr1, 3, 1e-3, 500).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_em.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of genome_chr1 by EM algorithm — result_em","text":"result_em list four elements.","code":""},{"path":[]},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_sqp.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of genome_chr1 by SQP algorithm — result_sqp","title":"Pre-training result of genome_chr1 by SQP algorithm — result_sqp","text":"result following code: psd_fit_sqp(genome_chr1, 3, 1e-3, 500, 100).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_sqp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of genome_chr1 by SQP algorithm — result_sqp","text":"result_sqp list four elements.","code":""},{"path":[]},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_vi.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-training result of genome_chr1 by VI algorithm — result_vi","title":"Pre-training result of genome_chr1 by VI algorithm — result_vi","text":"result following code: psd_fit_vi(genome_chr1, 3, 1e-9, 500).","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/result_vi.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-training result of genome_chr1 by VI algorithm — result_vi","text":"result_vi list four elements.","code":""},{"path":[]},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/structure_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the ancestral proportions — structure_plot","title":"Plot the ancestral proportions — structure_plot","text":"Plot ancestral proportions individuals using package ggplot2.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/structure_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the ancestral proportions — structure_plot","text":"","code":"structure_plot(L, topics, colors, ticks = NULL, font.size = 9)"},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/structure_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the ancestral proportions — structure_plot","text":"L proportion matrix. topics Topic order options. colors Theme color options. ticks Grouping options. font.size Font size used plot.","code":""},{"path":"https://jonathonchow.github.io/AwesomePackage/reference/structure_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the ancestral proportions — structure_plot","text":"","code":"P <- matrix(c(0.5,0.3,0.8, 0.5,0.7,0.2), 3, 2) topics <- order(colMeans(P)) colors <- c(\"red\", \"yellow\") structure_plot(P, topics, colors)"}]
